(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{H:()=>i});const t=(()=>{document.querySelectorAll(".game-panel");const e=document.querySelectorAll(".gameboard"),t=e[0],r=e[1];return{renderPlayerBoard:function e(r){const o=t;!function(e){e.textContent=""}(o);const a=n.buildPlayerBoard(r);r.areAllShipsPlaced()||a.addEventListener("click",(t=>function(t,n){const r=n.sideLength,o=t.target;if(o.classList.contains("board-cell")){const t=o.parentNode.children,a=Array.from(t).indexOf(o),s=Math.floor(a/r),l=a%r;n.setShip({x:l,y:s},"vertical"),e(n),n.areAllShipsPlaced()&&i()}}(t,r)),!0),o.appendChild(a)},renderOpponentBoard:function(e){const t=r,o=n.buildPlayerBoard(e);t.appendChild(o)}}})(),n={buildPlayerBoard:function(e){const t=document.createElement("div");t.classList.add("board-grid");for(let n of e.board)for(let e of n){const n=document.createElement("div");n.classList.add("board-cell"),e.hasShip()?n.classList.add("live-ship-cell"):e.isChecked&&n.classList.add("cell-checked"),t.appendChild(n)}return t}},r=t,o=()=>{const e={isChecked:!1,ship:null,shipIndex:null,assignShip(t,n){e.ship=t,e.shipIndex=n},hasShip:()=>null!==e.ship};return e},a=e=>{const t=e,n=function(e){let t=Array(e);for(let n=0;n<e;n++){t[n]=Array(e);for(let r=0;r<e;r++)t[n][r]=o()}return t}(e);let r=[5,4,3,3,2];function a(e){return s.board[e.y][e.x]}const s={sideLength:t,board:n,ships:[],missed:[],areAllShipsPlaced:()=>r.length<=0,setShip(e,n){const o=((e,t,n)=>{const r={length:e,cells:Array(e).fill(!0),pos:t,orie:n,hit(e){r.cells[e]=!1},isSunk:()=>r.cells.every((e=>0==e))};return r})(r[0],e,n),l=function(e){const n=e.length,r=e.pos,o=e.orie;let s=[];for(let e=0;e<n;e++){let n;"horizontal"===o?r.x+e<t&&(n=a({x:r.x+e,y:r.y})):"vertical"===o&&r.y+e<t&&(n=a({x:r.x,y:r.y+e})),s.push([n,e])}return!!s.every((e=>void 0!==e[0]&&!e[0].hasShip()))&&(s.forEach((t=>{t[0].assignShip(e,t[1])})),!0)}(o);l&&(s.ships.push(o),r.shift())},scrambleShips(){for(;!s.areAllShipsPlaced();){const e=Math.floor(2*Math.random())?"horizontal":"vertical",n=Math.floor(Math.random()*t),r=Math.floor(Math.random()*t);s.setShip({x:n,y:r},e)}},recieveAttack(e){const t=a({x:e.x,y:e.y});if(t.hasShip()){const e=t.ship,n=t.shipIndex;e.hit(n),e.isSunk()&&s.ships.map((e=>e.isSunk())).every((e=>!0===e))}else s.missed.push(e);t.isChecked=!0},wasCellChecked:e=>!0===a(e).isChecked};return s},s=(e,t=!1)=>{function n(e,t){return!e.gameboard.wasCellChecked(t)&&(e.gameboard.recieveAttack(t),!0)}const r={name:e,isAI:t,gameboard:a(10),attackOpponent:n};return t&&(r.attackRandomCell=function(e){const t=e.gameboard.board.length;let r=!1;for(;!r;)r=n(e,{x:Math.floor(Math.random()*t),y:Math.floor(Math.random()*t)})}),r};let l;function i(){const e=l.length;for(console.log("GAME STARTED");;){l[0%e];break}}!function(){const e=s("One"),t=s("CPU",!0);l=[e,t],function(){const e=l[1].gameboard;e.scrambleShips(),r.renderOpponentBoard(e)}(),function(){const e=l[0].gameboard;r.renderPlayerBoard(e)}()}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QS9CUCxTQUEwQkQsR0FDeEIsTUFBTTdCLEVBQVM2QixFQUFTdEYsVUFBVXFDLE1BQU1vQixPQUV4QyxJQUFJK0IsR0FBZ0IsRUFDcEIsTUFBT0EsR0FLTEEsRUFBZ0JILEVBQWVDLEVBRG5CLENBQUMzRCxFQUhISixLQUFLQyxNQUFNRCxLQUFLcUQsU0FBV25CLEdBR3JCN0IsRUFGTkwsS0FBS0MsTUFBTUQsS0FBS3FELFNBQVduQixPQTRCbENkLEdDckNULElBQUk4QyxFQXdCSixTQUFTNUQsSUFFUCxNQUFNNkQsRUFBY0QsRUFBUWhDLE9BSTVCLElBRkFrQyxRQUFRQyxJQUFJLGtCQUVBLENBQ1lILEVBTmIsRUFNNkJDLEdBQ3RDLFFBOUJKLFdBQ0UsTUFBTUcsRUFBUyxFQUFPLE9BQ2hCQyxFQUFhLEVBQU8sT0FBTyxHQUVqQ0wsRUFBVSxDQUFDSSxFQUFRQyxHQVdyQixXQUNFLE1BQU1DLEVBQW9CTixFQUFRLEdBQUd6RixVQUVyQytGLEVBQWtCckIsZ0JBQ2xCLHNCQUE0QnFCLEdBZDVCQyxHQUlGLFdBQ0UsTUFBTUMsRUFBa0JSLEVBQVEsR0FBR3pGLFVBRW5DLG9CQUEwQmlHLEdBTjFCQyxHQTRCRkMsSSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZGlzcGxheUNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lT2JqZWN0cy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lT2JqZWN0cy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZU9iamVjdHMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgeyBnYW1lIH0gZnJvbSBcIi4vaW5kZXguanNcIjtcblxuY29uc3QgZGlzcGxheUNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICBjb25zdCBkaXNwbGF5R2FtZVBhbmVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYW1lLXBhbmVsJyk7XG4gIGNvbnN0IGRpc3BsYXlHYW1lYm9hcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdhbWVib2FyZCcpO1xuXG4gIGNvbnN0IHBsYXllckRpc3BsYXlHYW1lYm9hcmQgPSBkaXNwbGF5R2FtZWJvYXJkc1swXTtcbiAgY29uc3Qgb3Bwb25lbnREaXNwbGF5R2FtZWJvYXJkID0gZGlzcGxheUdhbWVib2FyZHNbMV07XG5cbiAgbGV0IHNlbGVjdGVkUm90YXRpb24gPSAndmVydGljYWwnO1xuXG4gIGZ1bmN0aW9uIGNsZWFyRGlzcGxheUJvYXJkKGRpc3BsYXlHYW1lYm9hcmQpIHtcbiAgICBkaXNwbGF5R2FtZWJvYXJkLnRleHRDb250ZW50ID0gJyc7XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJQbGF5ZXJCb2FyZChnYW1lYm9hcmQpIHtcbiAgICBjb25zdCBkaXNwbGF5R2FtZWJvYXJkID0gcGxheWVyRGlzcGxheUdhbWVib2FyZDtcbiAgICBjbGVhckRpc3BsYXlCb2FyZChkaXNwbGF5R2FtZWJvYXJkKTtcblxuICAgIGNvbnN0IGRpc3BsYXlHcmlkID0gZWxlbWVudEJ1aWxkZXIuYnVpbGRQbGF5ZXJCb2FyZChnYW1lYm9hcmQpO1xuICAgIGlmICghZ2FtZWJvYXJkLmFyZUFsbFNoaXBzUGxhY2VkKCkpIHtcbiAgICAgIGRpc3BsYXlHcmlkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4gX2FkZFNoaXAoZXZ0LCBnYW1lYm9hcmQpLCB0cnVlKTtcbiAgICB9XG4gICAgZGlzcGxheUdhbWVib2FyZC5hcHBlbmRDaGlsZChkaXNwbGF5R3JpZCk7XG4gIH1cblxuICBmdW5jdGlvbiBfYWRkU2hpcChldnQsIGdhbWVib2FyZCkge1xuICAgIGNvbnN0IHNpemUgPSBnYW1lYm9hcmQuc2lkZUxlbmd0aDtcblxuICAgIGNvbnN0IHRhcmdldCA9IGV2dC50YXJnZXQ7XG4gICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2JvYXJkLWNlbGwnKSkge1xuICAgICAgY29uc3QgZ3JpZENlbGxzID0gdGFyZ2V0LnBhcmVudE5vZGUuY2hpbGRyZW47XG4gICAgICBjb25zdCB0YXJnZXRJbmRleCA9ICBBcnJheS5mcm9tKGdyaWRDZWxscykuaW5kZXhPZih0YXJnZXQpO1xuXG4gICAgICBjb25zdCB0YXJnZXRSb3cgPSBNYXRoLmZsb29yKHRhcmdldEluZGV4IC8gc2l6ZSk7XG4gICAgICBjb25zdCB0YXJnZXRDb2wgPSB0YXJnZXRJbmRleCAlIHNpemU7XG5cbiAgICAgIGdhbWVib2FyZC5zZXRTaGlwKHt4OnRhcmdldENvbCwgeTp0YXJnZXRSb3d9LCBzZWxlY3RlZFJvdGF0aW9uKTtcblxuICAgICAgcmVuZGVyUGxheWVyQm9hcmQoZ2FtZWJvYXJkKVxuICAgICAgaWYoZ2FtZWJvYXJkLmFyZUFsbFNoaXBzUGxhY2VkKCkpIHtcbiAgICAgICAgZ2FtZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlck9wcG9uZW50Qm9hcmQoZ2FtZWJvYXJkKSB7XG4gICAgY29uc3QgZGlzcGxheUdhbWVib2FyZCA9IG9wcG9uZW50RGlzcGxheUdhbWVib2FyZDtcbiAgICBjb25zdCBkaXNwbGF5R3JpZCA9IGVsZW1lbnRCdWlsZGVyLmJ1aWxkUGxheWVyQm9hcmQoZ2FtZWJvYXJkKTtcbiAgICBkaXNwbGF5R2FtZWJvYXJkLmFwcGVuZENoaWxkKGRpc3BsYXlHcmlkKTtcbiAgfVxuXG4gIGNvbnN0IHJldHMgPSB7XG4gICAgcmVuZGVyUGxheWVyQm9hcmQsXG4gICAgcmVuZGVyT3Bwb25lbnRCb2FyZFxuICB9O1xuXG4gIHJldHVybiByZXRzO1xufSkoKTtcblxuY29uc3QgZWxlbWVudEJ1aWxkZXIgPSAoKCkgPT4ge1xuICBmdW5jdGlvbiBidWlsZFBsYXllckJvYXJkKGdhbWVib2FyZCkge1xuICAgIGNvbnN0IGJvYXJkR3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJvYXJkR3JpZC5jbGFzc0xpc3QuYWRkKCdib2FyZC1ncmlkJyk7XG5cbiAgICBmb3IgKGxldCByb3cgb2YgZ2FtZWJvYXJkLmJvYXJkKSB7XG4gICAgICBmb3IgKGxldCBjZWxsIG9mIHJvdykge1xuICAgICAgICBjb25zdCBib2FyZENlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgYm9hcmRDZWxsLmNsYXNzTGlzdC5hZGQoJ2JvYXJkLWNlbGwnKTtcblxuICAgICAgICBpZiAoY2VsbC5oYXNTaGlwKCkpIHtcbiAgICAgICAgICBib2FyZENlbGwuY2xhc3NMaXN0LmFkZCgnbGl2ZS1zaGlwLWNlbGwnKTtcbiAgICAgICAgfSBlbHNlIGlmIChjZWxsLmlzQ2hlY2tlZCkge1xuICAgICAgICAgIGJvYXJkQ2VsbC5jbGFzc0xpc3QuYWRkKCdjZWxsLWNoZWNrZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJvYXJkR3JpZC5hcHBlbmRDaGlsZChib2FyZENlbGwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBib2FyZEdyaWQ7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGJ1aWxkUGxheWVyQm9hcmRcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGRpc3BsYXlDb250cm9sbGVyOyIsImltcG9ydCBTaGlwIGZyb20gXCIuL3NoaXAuanNcIjtcblxuY29uc3QgQ2VsbCA9ICgpID0+IHtcbiAgY29uc3QgcmV0cyA9IHtcbiAgICBpc0NoZWNrZWQ6IGZhbHNlLFxuXG4gICAgc2hpcDogbnVsbCxcbiAgICBzaGlwSW5kZXg6IG51bGwsXG4gICAgYXNzaWduU2hpcChzaGlwLCBpbmRleCkge1xuICAgICAgcmV0cy5zaGlwID0gc2hpcDtcbiAgICAgIHJldHMuc2hpcEluZGV4ID0gaW5kZXg7XG4gICAgfSxcbiAgICBoYXNTaGlwKCkge1xuICAgICAgcmV0dXJuIHJldHMuc2hpcCAhPT0gbnVsbDtcbiAgICB9LFxuICB9O1xuXG4gIHJldHVybiByZXRzO1xufTtcblxuY29uc3QgR2FtZWJvYXJkID0gKHNpemUpID0+IHtcbiAgY29uc3Qgc2lkZUxlbmd0aCA9IHNpemU7XG4gIGNvbnN0IGJvYXJkID0gX2NyZWF0ZUJvYXJkR3JpZChzaXplKTtcbiAgY29uc3Qgc2hpcHMgPSBbXTtcbiAgY29uc3QgbWlzc2VkID0gW107XG5cbiAgbGV0IG5leHRTaGlwTGVuZ3RocyA9IFs1LCA0LCAzLCAzLCAyXTtcblxuICBmdW5jdGlvbiBfY3JlYXRlQm9hcmRHcmlkKHNpemUpIHtcbiAgICBsZXQgZ3JpZCA9IEFycmF5KHNpemUpO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgc2l6ZTsgcisrKSB7XG4gICAgICBncmlkW3JdID0gQXJyYXkoc2l6ZSk7XG4gICAgICBmb3IgKGxldCBjID0gMDsgYyA8IHNpemU7IGMrKykge1xuICAgICAgICBncmlkW3JdW2NdID0gQ2VsbCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBncmlkO1xuICB9XG5cbiAgZnVuY3Rpb24gYXNzaWduU2hpcENlbGxzKHNoaXApIHtcbiAgICBjb25zdCBsZW5ndGggPSBzaGlwLmxlbmd0aDtcbiAgICBjb25zdCBzdGFydFBvcyA9IHNoaXAucG9zO1xuICAgIGNvbnN0IG9yaWUgPSBzaGlwLm9yaWU7XG5cbiAgICBsZXQgdG9PY2N1cHlDZWxscyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGNlbGwgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAob3JpZSA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgICAgaWYgKHN0YXJ0UG9zLnggKyBpIDwgc2lkZUxlbmd0aCkge1xuICAgICAgICAgIGNlbGwgPSBnZXRDZWxsKHtcbiAgICAgICAgICAgIHg6IHN0YXJ0UG9zLnggKyBpLFxuICAgICAgICAgICAgeTogc3RhcnRQb3MueSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChvcmllID09PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgICAgaWYgKHN0YXJ0UG9zLnkgKyBpIDwgc2lkZUxlbmd0aCkge1xuICAgICAgICAgIGNlbGwgPSBnZXRDZWxsKHtcbiAgICAgICAgICAgIHg6IHN0YXJ0UG9zLngsXG4gICAgICAgICAgICB5OiBzdGFydFBvcy55ICsgaSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdG9PY2N1cHlDZWxscy5wdXNoKFtjZWxsLCBpXSk7XG4gICAgfVxuXG4gICAgY29uc3QgYXJlTGVnYWxQbGFjZW1lbnRzID0gdG9PY2N1cHlDZWxscy5ldmVyeSgoY2VsbCkgPT4ge1xuICAgICAgaWYgKGNlbGxbMF0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoY2VsbFswXS5oYXNTaGlwKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG5cbiAgICBpZiAoYXJlTGVnYWxQbGFjZW1lbnRzKSB7XG4gICAgICB0b09jY3VweUNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgY2VsbFswXS5hc3NpZ25TaGlwKHNoaXAsIGNlbGxbMV0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gYXJlQWxsU2hpcHNTdW5rKCkge1xuICAgIHJldHVybiByZXRzLnNoaXBzXG4gICAgICAubWFwKChzaGlwKSA9PiB7XG4gICAgICAgIHJldHVybiBzaGlwLmlzU3VuaygpO1xuICAgICAgfSlcbiAgICAgIC5ldmVyeSgoYm9vbFZhbHVlKSA9PiB7XG4gICAgICAgIHJldHVybiBib29sVmFsdWUgPT09IHRydWU7XG4gICAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENlbGwocG9zKSB7XG4gICAgcmV0dXJuIHJldHMuYm9hcmRbcG9zLnldW3Bvcy54XTtcbiAgfVxuXG4gIGNvbnN0IHJldHMgPSB7XG4gICAgc2lkZUxlbmd0aCxcbiAgICBib2FyZCxcbiAgICBzaGlwcyxcbiAgICBtaXNzZWQsXG5cbiAgICBhcmVBbGxTaGlwc1BsYWNlZCgpIHtcbiAgICAgIHJldHVybiBuZXh0U2hpcExlbmd0aHMubGVuZ3RoIDw9IDA7XG4gICAgfSxcbiAgICBzZXRTaGlwKHBvcywgb3JpZSkge1xuICAgICAgY29uc3QgbGVuZ3RoID0gbmV4dFNoaXBMZW5ndGhzWzBdO1xuICAgICAgY29uc3Qgc2hpcCA9IFNoaXAobGVuZ3RoLCBwb3MsIG9yaWUpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXNzaWduU2hpcENlbGxzKHNoaXApO1xuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICByZXRzLnNoaXBzLnB1c2goc2hpcCk7XG4gICAgICAgIG5leHRTaGlwTGVuZ3Rocy5zaGlmdCgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2NyYW1ibGVTaGlwcygpIHtcbiAgICAgIHdoaWxlICghcmV0cy5hcmVBbGxTaGlwc1BsYWNlZCgpKSB7XG4gICAgICAgIGNvbnN0IHJhbmRPcmllID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpKSA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICAgIGNvbnN0IHJhbmRYID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2lkZUxlbmd0aCk7XG4gICAgICAgIGNvbnN0IHJhbmRZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2lkZUxlbmd0aCk7XG5cbiAgICAgICAgcmV0cy5zZXRTaGlwKHt4OiByYW5kWCwgeTogcmFuZFl9LCByYW5kT3JpZSk7XG4gICAgICB9XG4gICAgfSxcbiAgICByZWNpZXZlQXR0YWNrKHBvcykge1xuICAgICAgY29uc3QgY2VsbCA9IGdldENlbGwoe1xuICAgICAgICB4OiBwb3MueCxcbiAgICAgICAgeTogcG9zLnksXG4gICAgICB9KTtcbiAgICAgIGlmIChjZWxsLmhhc1NoaXAoKSkge1xuICAgICAgICBjb25zdCBzaGlwID0gY2VsbC5zaGlwO1xuICAgICAgICBjb25zdCBzaGlwSW5kZXggPSBjZWxsLnNoaXBJbmRleDtcbiAgICAgICAgc2hpcC5oaXQoc2hpcEluZGV4KTtcblxuICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgICAgICAgIC8vIFNoaXAgc3Vua2VuIGNvZGUgaGVyZVxuXG4gICAgICAgICAgaWYgKGFyZUFsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgICAgICAvLyBHYW1lb3ZlciBjb2RlL2Z1bmN0aW9uIGNhbGwgaGVyZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0cy5taXNzZWQucHVzaChwb3MpO1xuICAgICAgfVxuICAgICAgY2VsbC5pc0NoZWNrZWQgPSB0cnVlO1xuICAgIH0sXG4gICAgd2FzQ2VsbENoZWNrZWQocG9zKSB7XG4gICAgICByZXR1cm4gZ2V0Q2VsbChwb3MpLmlzQ2hlY2tlZCA9PT0gdHJ1ZTtcbiAgICB9LFxuICB9O1xuXG4gIHJldHVybiByZXRzO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkO1xuIiwiY29uc3QgU2hpcCA9IChsZW5ndGgsIHBvcywgb3JpZSkgPT4ge1xuICBjb25zdCBjZWxscyA9IEFycmF5KGxlbmd0aCkuZmlsbCh0cnVlKTtcblxuICBjb25zdCByZXRzID0ge1xuICAgIGxlbmd0aCxcbiAgICBjZWxscyxcbiAgICBwb3MsXG4gICAgb3JpZSxcbiAgICBoaXQoY2VsbEluZGV4KSB7XG4gICAgICByZXRzLmNlbGxzW2NlbGxJbmRleF0gPSBmYWxzZTtcbiAgICB9LFxuICAgIGlzU3VuaygpIHtcbiAgICAgIHJldHVybiByZXRzLmNlbGxzLmV2ZXJ5KGNlbGwgPT4gKGNlbGwgPT0gZmFsc2UpKTtcbiAgICB9LFxuICB9O1xuXG4gIHJldHVybiByZXRzO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU2hpcDsiLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuXG5jb25zdCBnYW1lYm9hcmRTaXplID0gMTBcblxuY29uc3QgUGxheWVyID0gKG5hbWUsIGlzQUk9ZmFsc2UpID0+IHtcbiAgY29uc3QgZ2FtZWJvYXJkID0gR2FtZWJvYXJkKGdhbWVib2FyZFNpemUpO1xuXG4gIGZ1bmN0aW9uIGF0dGFja1JhbmRvbUNlbGwob3Bwb25lbnQpIHtcbiAgICBjb25zdCBsZW5ndGggPSBvcHBvbmVudC5nYW1lYm9hcmQuYm9hcmQubGVuZ3RoO1xuXG4gICAgbGV0IGF0dGFja1N1Y2Nlc3MgPSBmYWxzZTtcbiAgICB3aGlsZSghYXR0YWNrU3VjY2Vzcykge1xuICAgICAgY29uc3QgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGxlbmd0aCk7XG4gICAgICBjb25zdCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbGVuZ3RoKTtcblxuICAgICAgY29uc3QgcG9zID0ge3gsIHl9O1xuICAgICAgYXR0YWNrU3VjY2VzcyA9IGF0dGFja09wcG9uZW50KG9wcG9uZW50LCBwb3MpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFJldHVybnMgdHJ1ZSBpZiB0YXJnZXQgcG9zaXRpb24gaXMgYSB2YWxpZCBjbGVsbFxuICAvLyBSZXR1cm5zIGZhbHNlIG90aGVyd2lzZVxuICBmdW5jdGlvbiBhdHRhY2tPcHBvbmVudChvcHBvbmVudCwgcG9zKSB7XG4gICAgaWYoIW9wcG9uZW50LmdhbWVib2FyZC53YXNDZWxsQ2hlY2tlZChwb3MpKSB7XG4gICAgICBvcHBvbmVudC5nYW1lYm9hcmQucmVjaWV2ZUF0dGFjayhwb3MpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IHJldHMgPSB7XG4gICAgbmFtZSxcbiAgICBpc0FJLFxuICAgIGdhbWVib2FyZCxcbiAgICBhdHRhY2tPcHBvbmVudFxuICB9O1xuXG4gIGlmIChpc0FJKSB7XG4gICAgcmV0cy5hdHRhY2tSYW5kb21DZWxsID0gYXR0YWNrUmFuZG9tQ2VsbDtcbiAgfVxuXG4gIHJldHVybiByZXRzO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgUGxheWVyOyIsImltcG9ydCBkaXNwbGF5IGZyb20gXCIuL2Rpc3BsYXlDb250cm9sbGVyXCI7XG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL2dhbWVPYmplY3RzL3BsYXllclwiO1xuaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9nYW1lT2JqZWN0cy9nYW1lYm9hcmRcIjtcblxubGV0IHBsYXllcnMgPSB1bmRlZmluZWQ7XG5cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuICBjb25zdCBwbGF5ZXIgPSBQbGF5ZXIoJ09uZScpXG4gIGNvbnN0IGNvbXB1dGVyQUkgPSBQbGF5ZXIoJ0NQVScsIHRydWUpXG5cbiAgcGxheWVycyA9IFtwbGF5ZXIsIGNvbXB1dGVyQUldO1xuICBjb21wdXRlclNldHVwKCk7XG4gIHBsYXllclNldHVwKCk7XG59XG5cbmZ1bmN0aW9uIHBsYXllclNldHVwKCkge1xuICBjb25zdCBwbGF5ZXJHYW1lYm9hcmQgPSBwbGF5ZXJzWzBdLmdhbWVib2FyZDtcblxuICBkaXNwbGF5LnJlbmRlclBsYXllckJvYXJkKHBsYXllckdhbWVib2FyZCk7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVyU2V0dXAoKSB7XG4gIGNvbnN0IG9wcG9uZW50R2FtZWJvYXJkID0gcGxheWVyc1sxXS5nYW1lYm9hcmQ7XG5cbiAgb3Bwb25lbnRHYW1lYm9hcmQuc2NyYW1ibGVTaGlwcygpXG4gIGRpc3BsYXkucmVuZGVyT3Bwb25lbnRCb2FyZChvcHBvbmVudEdhbWVib2FyZCk7XG59XG5cbmZ1bmN0aW9uIGdhbWUoKSB7XG4gIGxldCB0dXJuID0gMDtcbiAgY29uc3QgcGxheWVyQ291bnQgPSBwbGF5ZXJzLmxlbmd0aDtcblxuICBjb25zb2xlLmxvZygnR0FNRSBTVEFSVEVEJyk7XG5cbiAgd2hpbGUodHJ1ZSkge1xuICAgIGNvbnN0IGN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJzWyh0dXJuICUgcGxheWVyQ291bnQpXTtcbiAgICBicmVhaztcbiAgfVxufVxuXG5zdGFydCgpO1xuXG5leHBvcnQge2dhbWV9OyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRpc3BsYXlDb250cm9sbGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGlzcGxheUdhbWVib2FyZHMiLCJwbGF5ZXJEaXNwbGF5R2FtZWJvYXJkIiwib3Bwb25lbnREaXNwbGF5R2FtZWJvYXJkIiwicmVuZGVyUGxheWVyQm9hcmQiLCJnYW1lYm9hcmQiLCJkaXNwbGF5R2FtZWJvYXJkIiwidGV4dENvbnRlbnQiLCJjbGVhckRpc3BsYXlCb2FyZCIsImRpc3BsYXlHcmlkIiwiZWxlbWVudEJ1aWxkZXIiLCJidWlsZFBsYXllckJvYXJkIiwiYXJlQWxsU2hpcHNQbGFjZWQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0Iiwic2l6ZSIsInNpZGVMZW5ndGgiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImdyaWRDZWxscyIsInBhcmVudE5vZGUiLCJjaGlsZHJlbiIsInRhcmdldEluZGV4IiwiQXJyYXkiLCJmcm9tIiwiaW5kZXhPZiIsInRhcmdldFJvdyIsIk1hdGgiLCJmbG9vciIsInRhcmdldENvbCIsInNldFNoaXAiLCJ4IiwieSIsImdhbWUiLCJfYWRkU2hpcCIsImFwcGVuZENoaWxkIiwicmVuZGVyT3Bwb25lbnRCb2FyZCIsImJvYXJkR3JpZCIsImNyZWF0ZUVsZW1lbnQiLCJhZGQiLCJyb3ciLCJib2FyZCIsImNlbGwiLCJib2FyZENlbGwiLCJoYXNTaGlwIiwiaXNDaGVja2VkIiwiQ2VsbCIsInJldHMiLCJzaGlwIiwic2hpcEluZGV4IiwiYXNzaWduU2hpcCIsImluZGV4IiwiZ3JpZCIsInIiLCJjIiwiX2NyZWF0ZUJvYXJkR3JpZCIsIm5leHRTaGlwTGVuZ3RocyIsImdldENlbGwiLCJwb3MiLCJzaGlwcyIsIm1pc3NlZCIsImxlbmd0aCIsIm9yaWUiLCJjZWxscyIsImZpbGwiLCJoaXQiLCJjZWxsSW5kZXgiLCJpc1N1bmsiLCJldmVyeSIsInJlc3VsdCIsInN0YXJ0UG9zIiwidG9PY2N1cHlDZWxscyIsImkiLCJwdXNoIiwidW5kZWZpbmVkIiwiZm9yRWFjaCIsImFzc2lnblNoaXBDZWxscyIsInNoaWZ0Iiwic2NyYW1ibGVTaGlwcyIsInJhbmRPcmllIiwicmFuZG9tIiwicmFuZFgiLCJyYW5kWSIsInJlY2lldmVBdHRhY2siLCJtYXAiLCJib29sVmFsdWUiLCJ3YXNDZWxsQ2hlY2tlZCIsIm5hbWUiLCJpc0FJIiwiYXR0YWNrT3Bwb25lbnQiLCJvcHBvbmVudCIsImF0dGFja1JhbmRvbUNlbGwiLCJhdHRhY2tTdWNjZXNzIiwicGxheWVycyIsInBsYXllckNvdW50IiwiY29uc29sZSIsImxvZyIsInBsYXllciIsImNvbXB1dGVyQUkiLCJvcHBvbmVudEdhbWVib2FyZCIsImNvbXB1dGVyU2V0dXAiLCJwbGF5ZXJHYW1lYm9hcmQiLCJwbGF5ZXJTZXR1cCIsInN0YXJ0Il0sInNvdXJjZVJvb3QiOiIifQ==